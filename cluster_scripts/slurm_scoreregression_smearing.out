Using TensorFlow backend.
09.04.2018 18:13:14 INFO    Hi! How are you today?
09.04.2018 18:13:14 INFO    Startup options:
09.04.2018 18:13:14 INFO      Algorithm:                     scoreregression
09.04.2018 18:13:14 INFO      Point by point:                False
09.04.2018 18:13:14 INFO      Morphing-aware mode:           False
09.04.2018 18:13:14 INFO      Smeared data:                  True
09.04.2018 18:13:14 INFO      Training sample:               baseline
09.04.2018 18:13:14 INFO      alpha:                         None
09.04.2018 18:13:14 INFO      Histogram / AFC X indices:     [1, 38, 39, 40, 41]
09.04.2018 18:13:14 INFO      AFC epsilon:                   None
09.04.2018 18:13:14 INFO      Denominator theta:             True
09.04.2018 18:13:14 INFO      Neyman construction toys:      0
09.04.2018 18:13:14 INFO      Other options:                 ['deep', 'neyman2']
09.04.2018 18:13:14 INFO      Base directory:                /home/jb6504/higgs_inference
09.04.2018 18:13:14 INFO      ML-based strategies available: True
09.04.2018 18:13:14 INFO    Starting score regression inference
09.04.2018 18:13:14 INFO    Options:
09.04.2018 18:13:14 INFO      Denominator theta:       denominator 0 = theta 708 = [ 0.39293227  0.43229216]
09.04.2018 18:13:14 INFO      Number of hidden layers: 5
09.04.2018 18:13:14 INFO      Batch size:              128
09.04.2018 18:13:14 INFO      Learning rate:           0.001
09.04.2018 18:13:14 INFO      Learning rate decay:     0.0921034037198
09.04.2018 18:13:14 INFO      Number of epochs:        50
09.04.2018 18:13:14 INFO      NC experiments:          (10000 alternate + 10000 null) experiments with 1 alternate events each
09.04.2018 18:13:53 INFO    Starting training of score regression
Train on 8000000 samples, validate on 2000000 samples
2018-04-09 18:13:53.900467: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-04-09 18:13:53.900722: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-04-09 18:13:53.900732: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-04-09 18:13:53.900736: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-04-09 18:13:53.900740: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2018-04-09 18:13:54.219471: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: Tesla P40
major: 6 minor: 1 memoryClockRate (GHz) 1.531
pciBusID 0000:84:00.0
Total memory: 22.38GiB
Free memory: 22.21GiB
2018-04-09 18:13:54.219510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0 
2018-04-09 18:13:54.219516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y 
2018-04-09 18:13:54.219525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla P40, pci bus id: 0000:84:00.0)
Epoch 1/50
402s - loss: 0.0781 - val_loss: 0.0707
Epoch 2/50
401s - loss: 0.0587 - val_loss: 0.0568
Epoch 3/50
401s - loss: 0.0532 - val_loss: 0.0552
Epoch 4/50
401s - loss: 0.0492 - val_loss: 0.0426
Epoch 5/50
402s - loss: 0.0463 - val_loss: 0.0374
Epoch 6/50
401s - loss: 0.0426 - val_loss: 0.0350
Epoch 7/50
401s - loss: 0.0378 - val_loss: 0.0331
Epoch 8/50
401s - loss: 0.0357 - val_loss: 0.0280
Epoch 9/50
401s - loss: 0.0332 - val_loss: 0.0278
Epoch 10/50
402s - loss: 0.0296 - val_loss: 0.0239
Epoch 11/50
402s - loss: 0.0268 - val_loss: 0.0228
Epoch 12/50
401s - loss: 0.0254 - val_loss: 0.0227
Epoch 13/50
401s - loss: 0.0244 - val_loss: 0.0216
Epoch 14/50
401s - loss: 0.0226 - val_loss: 0.0201
Epoch 15/50
401s - loss: 0.0217 - val_loss: 0.0179
Epoch 16/50
401s - loss: 0.0208 - val_loss: 0.0185
Epoch 17/50
401s - loss: 0.0203 - val_loss: 0.0180
Epoch 18/50
400s - loss: 0.0194 - val_loss: 0.0163
Epoch 19/50
401s - loss: 0.0189 - val_loss: 0.0166
Epoch 20/50
401s - loss: 0.0180 - val_loss: 0.0151
Epoch 21/50
401s - loss: 0.0176 - val_loss: 0.0152
Epoch 22/50
400s - loss: 0.0171 - val_loss: 0.0158
Epoch 23/50
401s - loss: 0.0168 - val_loss: 0.0168
Epoch 24/50
401s - loss: 0.0165 - val_loss: 0.0141
Epoch 25/50
401s - loss: 0.0162 - val_loss: 0.0149
Epoch 26/50
401s - loss: 0.0158 - val_loss: 0.0140
Epoch 27/50
401s - loss: 0.0156 - val_loss: 0.0155
Epoch 28/50
401s - loss: 0.0154 - val_loss: 0.0144
Epoch 29/50
401s - loss: 0.0152 - val_loss: 0.0142
Epoch 30/50
401s - loss: 0.0151 - val_loss: 0.0128
Epoch 31/50
401s - loss: 0.0149 - val_loss: 0.0135
Epoch 32/50
401s - loss: 0.0148 - val_loss: 0.0138
Epoch 33/50
402s - loss: 0.0146 - val_loss: 0.0134
Epoch 34/50
402s - loss: 0.0144 - val_loss: 0.0141
Epoch 35/50
401s - loss: 0.0144 - val_loss: 0.0133
Epoch 36/50
401s - loss: 0.0142 - val_loss: 0.0141
Epoch 37/50
402s - loss: 0.0142 - val_loss: 0.0132
Epoch 38/50
401s - loss: 0.0141 - val_loss: 0.0136
Epoch 39/50
401s - loss: 0.0140 - val_loss: 0.0130
Epoch 40/50
401s - loss: 0.0139 - val_loss: 0.0130
Epoch 41/50
402s - loss: 0.0138 - val_loss: 0.0129
Epoch 00040: early stopping
09.04.2018 22:48:23 INFO    Starting evaluation
09.04.2018 22:49:09 INFO    Score regression evaluation timing: 1.03156208992 s
09.04.2018 22:49:09 INFO    Starting density estimation
Traceback (most recent call last):
  File "experiments.py", line 131, in <module>
    options=args.options)
  File "/home/jb6504/higgs_inference/higgs_inference/strategies/score_regression.py", line 288, in score_regression_inference
    or (np.linspace(np.percentile(_tthat_calibration, 2.5) - np.percentile(_tthat_calibration, 97.5)))**2
TypeError: linspace() takes at least 2 arguments (1 given)
