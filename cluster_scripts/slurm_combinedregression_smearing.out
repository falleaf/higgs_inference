Using TensorFlow backend.
16.02.2018 07:00:08 INFO    Hi! How are you today?
16.02.2018 07:00:08 INFO    Startup options:
16.02.2018 07:00:08 INFO      Algorithm:                     combinedregression
16.02.2018 07:00:08 INFO      Point by point:                False
16.02.2018 07:00:08 INFO      Morphing-aware mode:           False
16.02.2018 07:00:08 INFO      Smeared data:                  True
16.02.2018 07:00:08 INFO      Training sample:               baseline
16.02.2018 07:00:08 INFO      AFC X indices:                 [1, 38, 39, 40, 41]
16.02.2018 07:00:08 INFO      alpha:                         None
16.02.2018 07:00:08 INFO      AFC epsilon:                   None
16.02.2018 07:00:08 INFO      Neyman construction toys:      False
16.02.2018 07:00:08 INFO      Other options:                 
16.02.2018 07:00:08 INFO      Base directory:                /home/jb6504/higgs_inference
16.02.2018 07:00:08 INFO      ML-based strategies available: True
16.02.2018 07:00:08 INFO    Starting parameterized inference
16.02.2018 07:00:08 INFO    Main settings:
16.02.2018 07:00:08 INFO      Algorithm:                combinedregression
16.02.2018 07:00:08 INFO      Morphing-aware:           False
16.02.2018 07:00:08 INFO      Training sample:          baseline
16.02.2018 07:00:08 INFO    Options:
16.02.2018 07:00:08 INFO      Number of hidden layers:  2
16.02.2018 07:00:08 INFO      alpha:                    100.0
16.02.2018 07:00:08 INFO      Batch size:               128
16.02.2018 07:00:08 INFO      Learning rate:            0.001
16.02.2018 07:00:08 INFO      Learning rate decay:      0.0921034037198
16.02.2018 07:00:08 INFO      Number of epochs:         50
16.02.2018 07:00:08 INFO      Debug mode:               False
16.02.2018 07:00:30 INFO    Starting training
Train on 7995920 samples, validate on 1998980 samples
2018-02-16 07:00:31.446527: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:31.446861: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:31.446870: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:31.446874: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:31.446878: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:31.728296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:05:00.0
Total memory: 11.17GiB
Free memory: 11.10GiB
2018-02-16 07:00:31.728332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0 
2018-02-16 07:00:31.728338: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y 
2018-02-16 07:00:31.728348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:05:00.0)
Epoch 1/50
Traceback (most recent call last):
  File "experiments.py", line 139, in <module>
    options=args.options)
  File "/home/jb6504/higgs_inference/higgs_inference/strategies/parameterized.py", line 360, in parameterized_inference
    history = regr.fit(X_thetas_train[::], y_logr_score_train[::], callbacks=callbacks, batch_size=batch_size)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/wrappers/scikit_learn.py", line 149, in fit
    history = self.model.fit(x, y, **fit_args)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/engine/training.py", line 1485, in fit
    initial_epoch=initial_epoch)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/engine/training.py", line 1146, in _fit_loop
    callbacks.on_batch_end(batch_index, batch_logs)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/callbacks.py", line 111, in on_batch_end
    callback.on_batch_end(batch, logs)
  File "/home/jb6504/higgs_inference/higgs_inference/models/ml_utils.py", line 65, in on_batch_end
    if self.n_batches_in_buffer >= self.n_batches_per_entry:
AttributeError: 'DetailedHistory' object has no attribute 'n_batches_per_entry'
Using TensorFlow backend.
16.02.2018 07:00:35 INFO    Hi! How are you today?
16.02.2018 07:00:35 INFO    Startup options:
16.02.2018 07:00:35 INFO      Algorithm:                     combinedregression
16.02.2018 07:00:35 INFO      Point by point:                False
16.02.2018 07:00:35 INFO      Morphing-aware mode:           False
16.02.2018 07:00:35 INFO      Smeared data:                  True
16.02.2018 07:00:35 INFO      Training sample:               random
16.02.2018 07:00:35 INFO      AFC X indices:                 [1, 38, 39, 40, 41]
16.02.2018 07:00:35 INFO      alpha:                         None
16.02.2018 07:00:35 INFO      AFC epsilon:                   None
16.02.2018 07:00:35 INFO      Neyman construction toys:      False
16.02.2018 07:00:35 INFO      Other options:                 
16.02.2018 07:00:35 INFO      Base directory:                /home/jb6504/higgs_inference
16.02.2018 07:00:35 INFO      ML-based strategies available: True
16.02.2018 07:00:35 INFO    Starting parameterized inference
16.02.2018 07:00:35 INFO    Main settings:
16.02.2018 07:00:35 INFO      Algorithm:                combinedregression
16.02.2018 07:00:35 INFO      Morphing-aware:           False
16.02.2018 07:00:35 INFO      Training sample:          random
16.02.2018 07:00:35 INFO    Options:
16.02.2018 07:00:35 INFO      Number of hidden layers:  2
16.02.2018 07:00:35 INFO      alpha:                    100.0
16.02.2018 07:00:35 INFO      Batch size:               128
16.02.2018 07:00:35 INFO      Learning rate:            0.001
16.02.2018 07:00:35 INFO      Learning rate decay:      0.0921034037198
16.02.2018 07:00:35 INFO      Number of epochs:         50
16.02.2018 07:00:35 INFO      Debug mode:               False
16.02.2018 07:00:57 INFO    Starting training
Train on 7997002 samples, validate on 1999251 samples
2018-02-16 07:00:58.592084: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:58.592400: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:58.592408: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:58.592413: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:58.592417: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2018-02-16 07:00:58.894454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties: 
name: Tesla K80
major: 3 minor: 7 memoryClockRate (GHz) 0.8235
pciBusID 0000:05:00.0
Total memory: 11.17GiB
Free memory: 11.10GiB
2018-02-16 07:00:58.894490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0 
2018-02-16 07:00:58.894496: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y 
2018-02-16 07:00:58.894511: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:05:00.0)
Epoch 1/50
Traceback (most recent call last):
  File "experiments.py", line 139, in <module>
    options=args.options)
  File "/home/jb6504/higgs_inference/higgs_inference/strategies/parameterized.py", line 360, in parameterized_inference
    history = regr.fit(X_thetas_train[::], y_logr_score_train[::], callbacks=callbacks, batch_size=batch_size)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/wrappers/scikit_learn.py", line 149, in fit
    history = self.model.fit(x, y, **fit_args)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/engine/training.py", line 1485, in fit
    initial_epoch=initial_epoch)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/engine/training.py", line 1146, in _fit_loop
    callbacks.on_batch_end(batch_index, batch_logs)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/callbacks.py", line 111, in on_batch_end
    callback.on_batch_end(batch, logs)
  File "/home/jb6504/higgs_inference/higgs_inference/models/ml_utils.py", line 65, in on_batch_end
    if self.n_batches_in_buffer >= self.n_batches_per_entry:
AttributeError: 'DetailedHistory' object has no attribute 'n_batches_per_entry'
