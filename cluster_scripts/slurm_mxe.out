Using TensorFlow backend.
28.06.2018 08:37:38 INFO    Hi! How are you today?
28.06.2018 08:37:38 INFO    Startup options:
28.06.2018 08:37:38 INFO      Algorithm:                     mxe
28.06.2018 08:37:38 INFO      Point by point:                False
28.06.2018 08:37:38 INFO      Morphing-aware mode:           False
28.06.2018 08:37:38 INFO      Smeared data:                  False
28.06.2018 08:37:38 INFO      Training sample:               baseline
28.06.2018 08:37:38 INFO      alpha:                         None
28.06.2018 08:37:38 INFO      Histogram / AFC X indices:     [1, 38, 39, 40, 41]
28.06.2018 08:37:38 INFO      AFC epsilon:                   None
28.06.2018 08:37:38 INFO      Denominator theta:             False
28.06.2018 08:37:38 INFO      Neyman construction toys:      0
28.06.2018 08:37:38 INFO      Training sample size limit:    None
28.06.2018 08:37:38 INFO      Other options:                 ['deep']
28.06.2018 08:37:38 INFO      Base directory:                /home/jb6504/higgs_inference
28.06.2018 08:37:38 INFO      ML-based strategies available: True
28.06.2018 08:37:38 INFO    Starting parameterized inference
28.06.2018 08:37:38 INFO    Main settings:
28.06.2018 08:37:38 INFO      Algorithm:                mxe
28.06.2018 08:37:38 INFO      Morphing-aware:           False
28.06.2018 08:37:38 INFO      Training sample:          baseline
28.06.2018 08:37:38 INFO      Denominator theta:        denominator 0 = theta 708 = [ 0.39293227  0.43229216]
28.06.2018 08:37:38 INFO    Options:
28.06.2018 08:37:38 INFO      Number of hidden layers:  5
28.06.2018 08:37:38 INFO      Batch size:               128
28.06.2018 08:37:38 INFO      Learning rate:            0.001
28.06.2018 08:37:38 INFO      Learning rate decay:      0.0921034037198
28.06.2018 08:37:38 INFO      Number of epochs:         50
28.06.2018 08:37:38 INFO      Training samples:         all
28.06.2018 08:37:38 INFO      NC experiments:           False
28.06.2018 08:37:38 INFO      Debug mode:               False
28.06.2018 08:38:20 INFO    Starting training
Train on 7999997 samples, validate on 2000000 samples
2018-06-28 08:38:20.920462: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2018-06-28 08:38:20.920828: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2018-06-28 08:38:20.920836: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2018-06-28 08:38:20.920840: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2018-06-28 08:38:20.920844: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2018-06-28 08:38:21.117663: E tensorflow/core/common_runtime/direct_session.cc:171] Internal: failed initializing StreamExecutor for CUDA device ordinal 0: Internal: failed call to cuDevicePrimaryCtxRetain: CUDA_ERROR_ECC_UNCORRECTABLE
Traceback (most recent call last):
  File "experiments.py", line 148, in <module>
    options=args.options)
  File "/home/jb6504/higgs_inference/higgs_inference/strategies/parameterized.py", line 459, in parameterized_inference
    history = regr.fit(X_thetas_train[::], y_logr_score_train[::], callbacks=callbacks, batch_size=batch_size)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/wrappers/scikit_learn.py", line 149, in fit
    history = self.model.fit(x, y, **fit_args)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/engine/training.py", line 1485, in fit
    initial_epoch=initial_epoch)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/engine/training.py", line 1116, in _fit_loop
    callbacks.on_epoch_begin(epoch)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/callbacks.py", line 61, in on_epoch_begin
    callback.on_epoch_begin(epoch, logs)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/callbacks.py", line 561, in on_epoch_begin
    K.set_value(self.model.optimizer.lr, lr)
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/backend/tensorflow_backend.py", line 1970, in set_value
    get_session().run(assign_op, feed_dict={assign_placeholder: value})
  File "/share/apps/keras/2.0.2/lib/python2.7/site-packages/Keras-2.0.2-py2.7.egg/keras/backend/tensorflow_backend.py", line 150, in get_session
    _SESSION = tf.Session(config=config)
  File "/share/apps/tensorflow/20170707/python2.7/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 1486, in __init__
    super(Session, self).__init__(target, graph, config=config)
  File "/share/apps/tensorflow/20170707/python2.7/lib/python2.7/site-packages/tensorflow/python/client/session.py", line 621, in __init__
    self._session = tf_session.TF_NewDeprecatedSession(opts, status)
  File "/share/apps/python/2.7.12/intel/lib/python2.7/contextlib.py", line 24, in __exit__
    self.gen.next()
  File "/share/apps/tensorflow/20170707/python2.7/lib/python2.7/site-packages/tensorflow/python/framework/errors_impl.py", line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InternalError: Failed to create session.
